pch=16,
cex=2,
col="#941914",
xlab="CalYrBP",
ylab="Metagenomic Metazoan Genus Richness",
xlim=c(0,8600))
axis(side = 2,col.axis = "#941914",col="#941914")
par(new = TRUE)
plot(dates$Median[match(as.factor(substr(names(MTB.binary.DS2),1,8)),dates$sampleID)],
colSums(MTB.binary.DS2),
axes=FALSE,
ylim=c(0,max(colSums(MTB.binary.DS2))),
pch=16,
cex=2,
col="#4583C4",
xlab="CalYrBP",
ylab="",
xlim=c(0,8600))
axis(side = 4,col.axis = "#4583C4",col="#4583C4")
mtext("Metabarcoding Metazoan ASV Richness", side = 4, line = 3)
dev.off()
pdf("figures/figure2/richness.MTG.DS1.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTG.binary.DS1),1,8)),dates$sampleID)],
colSums(MTG.binary.DS1),
pch=16,
cex=2,
col="#941914",
xlab="CalYrBP",
ylab="Metagenomic Genus Richness",
xlim=c(0,8600))
dev.off()
pdf("figures/figure2/richness.MTG.DS2.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTG.binary.DS2),1,8)),dates$sampleID)],
colSums(MTG.binary.DS2),
pch=16,
cex=2,
col="#941914",
xlab="CalYrBP",
ylab="Metagenomic Metazoa Genus Richness",
xlim=c(0,8600))
dev.off()
pdf("figures/figure2/richness.MTG.DS3.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTG.binary.DS3),1,8)),dates$sampleID)],
colSums(MTG.binary.DS3),
pch=16,
cex=2,
col="#941914",
xlab="CalYrBP",
ylab="MTG.DS3 Genus Richness",
xlim=c(0,8600))
dev.off()
pdf("figures/figure2/richness.MTG.DS4.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTG.binary.DS4),1,8)),dates$sampleID)],
colSums(MTG.binary.DS4),
pch=16,
cex=2,
col="#941914",
xlab="CalYrBP",
ylab="MTG.DS4 Genus Richness",
xlim=c(0,8600))
dev.off()
pdf("figures/figure2/richness.MTB.DS1.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTB.binary.DS1),1,8)),dates$sampleID)],
colSums(MTB.binary.DS1),
pch=16,
cex=2,
col="#4583C4",
xlab="CalYrBP",
ylab="Metabarcoding ASV Richness",
xlim=c(0,8600))
dev.off()
pdf("figures/figure2/richness.MTB.DS2.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(dates$Median[match(as.factor(substr(names(MTB.binary.DS2),1,8)),dates$sampleID)],
colSums(MTB.binary.DS2),
pch=16,
cex=2,
col="#4583C4",
xlab="CalYrBP",
ylab="Metabarcoding Metazoa ASV Richness",
xlim=c(0,8600))
dev.off()
colSums(MTG.binary.DS1)
colSums(MTB.binary.DS1)
pdf("figures/figure2/richness.comp.MTG.DS1-MTB.DS1.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(colSums(MTG.binary.DS1),
colSums(MTB.binary.DS1),
pch=16,
xlab="Genera",
ylab="ASVs")
test <- cor.test(colSums(MTG.binary.DS1),colSums(MTB.binary.DS1))
abline(lm(colSums(MTB.binary.DS1)~colSums(MTG.binary.DS1)),col="red")
legend("topright",legend=c(paste0("Corr = ",round(unname(test$estimate),3)),
paste0("p =",signif(test$p.value,3))),
text.col="red",bty="n")
dev.off()
pdf("figures/figure2/richness.comp.MTG.DS1-MTB.DS2.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(colSums(MTG.binary.DS1),
colSums(MTB.binary.DS2),
pch=16,
xlab="Genera",
ylab="ASVs")
test <- cor.test(colSums(MTG.binary.DS1),colSums(MTB.binary.DS2))
abline(lm(colSums(MTB.binary.DS2)~colSums(MTG.binary.DS1)),col="red")
legend("topright",legend=c(paste0("Corr = ",round(unname(test$estimate),3)),
paste0("p =",signif(test$p.value,3))),
text.col="red",bty="n")
dev.off()
#here we make a little index to subset the MTB dataset as MTG loses a sample
index <- match(names(colSums(MTG.binary.DS2)),names(colSums(MTB.binary.DS1)))
pdf("figures/figure2/richness.comp.MTG.DS2-MTB.DS1.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(colSums(MTG.binary.DS2),
colSums(MTB.binary.DS1)[index],
pch=16,
xlab="Genera",
ylab="ASVs")
test <- cor.test(colSums(MTG.binary.DS2),colSums(MTB.binary.DS1)[index])
abline(lm(colSums(MTB.binary.DS1)[index]~colSums(MTG.binary.DS2)),col="red")
legend("topright",legend=c(paste0("Corr = ",round(unname(test$estimate),3)),
paste0("p =",signif(test$p.value,3))),
text.col="red",bty="n")
dev.off()
index <- match(names(colSums(MTG.binary.DS2)),names(colSums(MTB.binary.DS2)))
pdf("figures/figure2/richness.comp.MTG.DS2-MTB.DS2.pdf",width = 4,height = 4)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(colSums(MTG.binary.DS2),
colSums(MTB.binary.DS2)[index],
pch=16,
xlab="Genera",
ylab="ASVs")
test <- cor.test(colSums(MTG.binary.DS2),colSums(MTB.binary.DS2)[index])
abline(lm(colSums(MTB.binary.DS2)[index]~colSums(MTG.binary.DS2)),col="red")
legend("topright",legend=c(paste0("Corr = ",round(unname(test$estimate),3)),
paste0("p =",signif(test$p.value,3))),
text.col="red",bty="n")
dev.off()
####====2.0 Beta Diversity Comparison  ====####
##MTG
MTG.wide.DS1 <- dcast(MTG.raw.DS1, tax_name ~ sample2, value.var="N_reads",fill = 0)
MTG.wide.DS2 <- dcast(MTG.raw.DS2, tax_name ~ sample2, value.var="N_reads",fill = 0)
MTG.wide.DS3 <- dcast(MTG.raw.DS3, tax_name ~ sample2, value.var="N_reads",fill = 0)
MTG.wide.DS4 <- dcast(MTG.raw.DS4, tax_name ~ sample2, value.var="N_reads",fill = 0)
##MTB
MTB.wide.DS1 <- euk.Nreps[,0:11]
MTB.wide.DS2 <- euk.Nreps[rownames(euk.Nreps) %in% taxPR2.f$X.1[taxPR2.f$tax.Subdivision=="Metazoa"],0:11]
### Lets look at some PCOA plots
library(ape)
library(vegan)
datain <- MTG.wide.DS1[,4:14]
datain <- MTB.wide.DS1
datain <- MTG.wide.DS2[,-1]
datain <- MTB.wide.DS2
PCOA <- pcoa(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"))
par(mfrow=c(1,3))
plot(PCOA$vectors[,1], PCOA$vectors[,2],pch=16,col= heat.colors(11),cex=2)
text(PCOA$vectors[,1], PCOA$vectors[,2],labels=names(PCOA$vectors[,1]))
plot(PCOA$vectors[,1], PCOA$vectors[,3],pch=16,col= heat.colors(11),cex=2)
text(PCOA$vectors[,1], PCOA$vectors[,3],labels=names(PCOA$vectors[,1]))
plot(PCOA$vectors[,2], PCOA$vectors[,3],pch=16,col= heat.colors(11),cex=2)
text(PCOA$vectors[,2], PCOA$vectors[,3],labels=names(PCOA$vectors[,1]))
##MTG DS1
datain <- MTG.wide.DS1[,4:14]
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTG.DS1.pdf",height = 5,width = 5,bg = "transparent")
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS1.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTG.DS1.j.pdf",height = 5,width = 5,bg = "transparent")
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS1.nMDS.j <- out
##MTG DS2
datain <- MTG.wide.DS2[,-1]
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTG.DS2.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS2.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTG.DS2.j.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS1.nMDS.j <- out
##MTG DS3
datain <- MTG.wide.DS3[,-1]
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTG.DS3.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS3.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTG.DS3.j.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS1.nMDS.j <- out
##DS4
datain <- MTG.wide.DS4[,-1]
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTG.DS4.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS4.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTG.DS4.j.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
box()
dev.off()
MTG.DS1.nMDS.j <- out
##MTB DS1
datain <- MTB.wide.DS1
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTB.DS1.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
dev.off()
MTB.DS1.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTB.DS1.j.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
dev.off()
MTG.DS1.nMDS.j <- out
##MTB DS2
datain <- MTB.wide.DS2
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
out <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2))),trymax = 200)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#bray
pdf("figures/figure3/beta.MTB.DS2.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
dev.off()
MTB.DS2.nMDS <- out
#jacc
out <- out.j
pdf("figures/figure3/beta.MTB.DS2.j.pdf",height = 5,width = 5)
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
dev.off()
MTG.DS1.nMDS.j <- out
datain <- MTG.wide.DS1[,4:14]
View(datain)
datain.2 <- datain[-,1]
datain.2 <- datain[,-1]
View(datain.2)
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain.2),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#jacc
out <- out.j
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
datain <- MTG.wide.DS1[,4:14]
colnames(datain) <- as.character(dates$Median[match(colnames(datain),dates$sampleID)])
datain.2 <- datain[,-1]
out.j <- metaMDS(vegdist(t(prop.table(as.matrix(datain.2),2)),binary = TRUE,method = "jaccard"),trymax = 200)
#jacc
out <- out.j
par(mar=c(4.1, 4.1, 1.1, 1.1))
plot(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,
ylim=c(min(out$points[,2])-0.1,max(out$points[,2])+0.1),
xlim=c(min(out$points[,1])-0.1,max(out$points[,1])+0.1),ylab="",xlab="")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "white", border = NA)
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
for (i in 1:(length(out$points[,1])-1)) {
arrows(out$points[i,1],
out$points[i,2],
out$points[i+1,1],
out$points[i+1,2],
length = 0.1,lwd = 1.5,col = "red3")}
points(out$points[,1],out$points[,2],col="darkred",cex=1.3,pch=16,)
text(out$points[,1],
out$points[,2]+0.1,
labels = rownames(out$points),
col="darkblue")
