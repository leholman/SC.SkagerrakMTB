pch=16,cex=1.5,ylab="ASV Richness (8rep)",xlab="CalYrBP")
dev.off()
### Here we are estimating richness using breakaway which uses this approach - https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12332
###since our metabarcoding data will only ever amplify a fraction of total biodiversity
###therefore these are useless as absolute estimates of richness but useful as relative measures of richness along the core
#we use the euk dataset as it contains read data
richEst <- breakaway(euk[,1:88])
richEst2 <-as.data.frame(richEst)
richEst2 <-as.data.frame(richEst)
####====0.0 Packages====####
library(tidyverse)
library(dplyr)
library(maditr)
library(vegan)
library(breakaway)
#### METABARCODING ####
euk <- read.csv("cleanedData/clean.EUK.raw.names.csv.csv",row.names = 1)
euk.Nreps <- read.csv("cleanedData/clean.EUK.raw.names.csv.Nreps.csv",row.names = 1)
dates <-read.csv("metadataAge.csv")
dates$sampleID <- gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1", dates$Sample))
taxPR2 <-read.csv("taxonomy/tax.PR2.csv",row.names = 1)
#Correct col names
colnames(euk) <- c(gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1",colnames(euk[,1:88]))),colnames(euk[,89:99]))
colnames(euk.Nreps) <- c(gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1",colnames(euk.Nreps[,1:11]))),colnames(euk.Nreps[,12:22]))
#Alpha diversity
pdf("figures/rarefaction.big.pdf",width = 20,height = 13)
rarecurve(t(euk[,1:88]),label=FALSE,step = 1000)
ordilabel(cbind(rowSums(t(euk[,1:88])), specnumber(t(euk[,1:88])))+5, labels=rownames(t(euk[,1:88])),cex=0.5, border = NA,fill=NULL,col="Darkred")
dev.off()
pdf("figures/rarefaction.small.pdf",width = 9,height = 6.5)
rarecurve(t(euk[,1:88]),label=FALSE,step = 1000)
ordilabel(cbind(rowSums(t(euk[,1:88])), specnumber(t(euk[,1:88])))+5, labels=rownames(t(euk[,1:88])),cex=0.5, border = NA,fill=NULL,col="Darkred")
dev.off()
##ASV richness (blind)
euk.Nreps.high.binary.1rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.1rep[euk.Nreps.high.binary.1rep>0.5] <- 1
euk.Nreps.high.binary.3rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.3rep[euk.Nreps.high.binary.3rep<3] <- 0
euk.Nreps.high.binary.3rep[euk.Nreps.high.binary.3rep>2.5] <- 1
euk.Nreps.high.binary.8rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.8rep[euk.Nreps.high.binary.8rep<8] <- 0
euk.Nreps.high.binary.8rep[euk.Nreps.high.binary.8rep>7.5] <- 1
pdf("figures/richness.sample.pdf",width = 8,height = 5)
par(mar=c(6.1,4.1,1.1,1.1),mfrow=c(1,3))
plot(colSums(euk.Nreps.high.binary.1rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.1rep),las=2,cex.axis=1)
plot(colSums(euk.Nreps.high.binary.3rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.3rep),las=2,cex.axis=1)
plot(colSums(euk.Nreps.high.binary.8rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.8rep),las=2,cex.axis=1)
dev.off()
pdf("figures/richness.date.pdf",width = 8,height = 5)
par(mar=c(5.1,4.1,1.1,1.1),mfrow=c(1,3))
plot(dates$Median[match(colnames(euk.Nreps.high.binary.1rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.1rep),
pch=16,cex=1.5,ylab="ASV Richness (1rep)",xlab="CalYrBP")
plot(dates$Median[match(colnames(euk.Nreps.high.binary.3rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.3rep),
pch=16,cex=1.5,ylab="ASV Richness (3rep)",xlab="CalYrBP")
plot(dates$Median[match(colnames(euk.Nreps.high.binary.8rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.8rep),
pch=16,cex=1.5,ylab="ASV Richness (8rep)",xlab="CalYrBP")
dev.off()
### Here we are estimating richness using breakaway which uses this approach - https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12332
###since our metabarcoding data will only ever amplify a fraction of total biodiversity
###therefore these are useless as absolute estimates of richness but useful as relative measures of richness along the core
#we use the euk dataset as it contains read data
richEst <- breakaway(euk[,1:88])
richEst2 <-as.data.frame(richEst)
View(euk)
richEstimate <- unlist(lapply(richEst,FUN = function(x){x[["estimate"]]}))
richEstimateCIlwr <- unlist(lapply(richEst,FUN = function(x){x[["ci"]][1]}))
richEstimateCIupr <- unlist(lapply(richEst,FUN = function(x){x[["ci"]][2]}))
substr(names(richEstimate),1,8)
plot(dates$Median[match(as.factor(substr(names(richEstimate),1,8)),dates$sampleID)],
richEstimate,pch=16,
xlab="CalYrBP",
ylab="EstimatedRichness")
points(dates$Median[match(as.factor(substr(names(richEstimate),1,8)),dates$sampleID)],
richEstimateCIlwr,pch="-",col="red")
points(dates$Median[match(as.factor(substr(names(richEstimate),1,8)),dates$sampleID)],
richEstimateCIupr,pch="-",col="red")
plot(richEstimate,colSums(euk.Nreps.high.binary.1rep))
colSums(euk.Nreps.high.binary.1rep)
names(richEstimate)
substr(names(richEstimate),8)
substr(names(richEstimate),1,8)
tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))
plot(richEstimate,tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))
richEstimate
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
par(mfrows = c(1,3))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
par(mfrow = c(1,3))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
par(mfrow = c(1,3))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=3,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=3,
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=3,
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
par(mfrow = c(1,3))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue"
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue",
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="dodgerblue",
xlab="Breakaway Estimate",ylab="Observed Richness (1rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="lightblue",
xlab="Breakaway Estimate",ylab="Observed Richness (3rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue",
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="dodgerblue")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200)
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100)
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
par(mfrow = c(1,1))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"))
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16)
?legend
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
pdf("figures/breakaway-richness.comp.pdf",width = 8,height = 5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
dev.off()
pdf("figures/breakaway-richness.comp.pdf",width = 8,height = 6.5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
dev.off()
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))
abline((tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
line((tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
abline((tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)),col="lightblue")
?abline
abline(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)),col="lightblue")
abline(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)),col="lightblue")
abline(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)),col="lightblue")
plot(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)),col="lightblue")
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)),col="lightblue")
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))
colSums(euk.Nreps.high.binary.1rep)
compRich <- data.frame("breakaway"=tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
View(compRich)
compRich <- data.frame("breakaway"=tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
"Richness.8rep"=colSums(euk.Nreps.high.binary.8rep),
"Richness.3rep"=colSums(euk.Nreps.high.binary.3rep),
"Richness.1rep"=colSums(euk.Nreps.high.binary.1rep))
View(compRich)
abline(lm(tapply(colSums(euk.Nreps.high.binary.1rep))~richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),col="lightblue")
abline(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),col="lightblue")~colSums(euk.Nreps.high.binary.1rep)
abline(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))
abline(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))),col="lightblue")
abline(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))),col="lightblue",lwd=1.5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))),col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(lm(colSums(euk.Nreps.high.binary.3rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))),col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(lm(colSums(euk.Nreps.high.binary.8rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))),col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
summary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))
)
)
lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
summary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))[r2]
summary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))[R2]
test <- ummary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))
test <- summary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))
str(test)
summary(lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))))[adj.r.squared]
m1 <- lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
m1 <- lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
m2 <- lm(colSums(euk.Nreps.high.binary.3rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
m3 <- lm(colSums(euk.Nreps.high.binary.8rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
str(m1)
str(test)
summary(m1)adj.r.squared
summary(m1)$adj.r.squared
text(1,200,summary(m1)$adj.r.squared)
text(100,2000,summary(m1)$adj.r.squared)
text(100,2000,round(summary(m1)$adj.r.squared),2)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex
dev.off()
text(100,2000,round(summary(m1)$adj.r.squared,2))
text(100,2000,round(summary(m1)$adj.r.squared,3))
text(100,2000,round(summary(m1)$adj.r.squared,5))
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex
dev.off()
text(100,2000,round(summary(m1)$adj.r.squared,5))
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
####====0.0 Packages====####
library(tidyverse)
library(dplyr)
library(maditr)
library(vegan)
library(breakaway)
#### METABARCODING ####
euk <- read.csv("cleanedData/clean.EUK.raw.names.csv.csv",row.names = 1)
euk.Nreps <- read.csv("cleanedData/clean.EUK.raw.names.csv.Nreps.csv",row.names = 1)
dates <-read.csv("metadataAge.csv")
dates$sampleID <- gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1", dates$Sample))
taxPR2 <-read.csv("taxonomy/tax.PR2.csv",row.names = 1)
#Correct col names
colnames(euk) <- c(gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1",colnames(euk[,1:88]))),colnames(euk[,89:99]))
colnames(euk.Nreps) <- c(gsub("\\.","-",gsub(".*(MD9.\\d{4})","\\1",colnames(euk.Nreps[,1:11]))),colnames(euk.Nreps[,12:22]))
#Alpha diversity
pdf("figures/rarefaction.big.pdf",width = 20,height = 13)
rarecurve(t(euk[,1:88]),label=FALSE,step = 1000)
ordilabel(cbind(rowSums(t(euk[,1:88])), specnumber(t(euk[,1:88])))+5, labels=rownames(t(euk[,1:88])),cex=0.5, border = NA,fill=NULL,col="Darkred")
dev.off()
pdf("figures/rarefaction.small.pdf",width = 9,height = 6.5)
rarecurve(t(euk[,1:88]),label=FALSE,step = 1000)
ordilabel(cbind(rowSums(t(euk[,1:88])), specnumber(t(euk[,1:88])))+5, labels=rownames(t(euk[,1:88])),cex=0.5, border = NA,fill=NULL,col="Darkred")
dev.off()
##ASV richness (blind)
euk.Nreps.high.binary.1rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.1rep[euk.Nreps.high.binary.1rep>0.5] <- 1
euk.Nreps.high.binary.3rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.3rep[euk.Nreps.high.binary.3rep<3] <- 0
euk.Nreps.high.binary.3rep[euk.Nreps.high.binary.3rep>2.5] <- 1
euk.Nreps.high.binary.8rep <- euk.Nreps[,1:11]
euk.Nreps.high.binary.8rep[euk.Nreps.high.binary.8rep<8] <- 0
euk.Nreps.high.binary.8rep[euk.Nreps.high.binary.8rep>7.5] <- 1
pdf("figures/richness.sample.pdf",width = 8,height = 5)
par(mar=c(6.1,4.1,1.1,1.1),mfrow=c(1,3))
plot(colSums(euk.Nreps.high.binary.1rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.1rep),las=2,cex.axis=1)
plot(colSums(euk.Nreps.high.binary.3rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.3rep),las=2,cex.axis=1)
plot(colSums(euk.Nreps.high.binary.8rep),pch=16,cex=1.5,xaxt="n",ylab="ASV Richness",xlab="")
axis(1,at=1:11,labels = colnames(euk.Nreps.high.binary.8rep),las=2,cex.axis=1)
dev.off()
pdf("figures/richness.date.pdf",width = 8,height = 5)
par(mar=c(5.1,4.1,1.1,1.1),mfrow=c(1,3))
plot(dates$Median[match(colnames(euk.Nreps.high.binary.1rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.1rep),
pch=16,cex=1.5,ylab="ASV Richness (1rep)",xlab="CalYrBP")
plot(dates$Median[match(colnames(euk.Nreps.high.binary.3rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.3rep),
pch=16,cex=1.5,ylab="ASV Richness (3rep)",xlab="CalYrBP")
plot(dates$Median[match(colnames(euk.Nreps.high.binary.8rep),dates$sampleID)],
colSums(euk.Nreps.high.binary.8rep),
pch=16,cex=1.5,ylab="ASV Richness (8rep)",xlab="CalYrBP")
dev.off()
### Here we are estimating richness using breakaway which uses this approach - https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12332
###since our metabarcoding data will only ever amplify a fraction of total biodiversity
###therefore these are useless as absolute estimates of richness but useful as relative measures of richness along the core
#we use the euk dataset as it contains read data
richEst <- breakaway(euk[,1:88])
richEstimate <- unlist(lapply(richEst,FUN = function(x){x[["estimate"]]}))
richEstimateCIlwr <- unlist(lapply(richEst,FUN = function(x){x[["ci"]][1]}))
richEstimateCIupr <- unlist(lapply(richEst,FUN = function(x){x[["ci"]][2]}))
pdf("figures/richness.freqEst.pdf",width = 8,height = 5)
plot(dates$Median[match(as.factor(substr(names(richEstimate),1,8)),dates$sampleID)],
richEstimate,pch=16,
xlab="CalYrBP",
ylab="EstimatedRichness")
dev.off()
## Are breakaway estimates and raw richness correlated?
compRich <- data.frame("breakaway"=tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
"Richness.8rep"=colSums(euk.Nreps.high.binary.8rep),
"Richness.3rep"=colSums(euk.Nreps.high.binary.3rep),
"Richness.1rep"=colSums(euk.Nreps.high.binary.1rep))
m1 <- lm(colSums(euk.Nreps.high.binary.1rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
m2 <- lm(colSums(euk.Nreps.high.binary.3rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
m3 <- lm(colSums(euk.Nreps.high.binary.8rep)~tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)))
pdf("figures/breakaway-richness.comp.pdf",width = 8,height = 6.5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
###insert R2 for models here
dev.off()
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared
summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
text(800,2000,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5))
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5))
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5),col="lightblue")
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5),col="lightblue")
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,5),col="dodgerblue")
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,5),col="darkblue")
?text
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5),col="lightblue",adj=0)
text(800,700,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,5),col="dodgerblue",adj=0)
text(800,200,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,5),col="darkblue",adj=0)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,5),col="lightblue",adj=0)
text(800,700,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,5),col="dodgerblue",adj=0)
text(800,200,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,5),col="darkblue",adj=0)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,4),col="lightblue",adj=0)
text(800,700,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,4),col="dodgerblue",adj=0)
text(800,200,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,4),col="darkblue",adj=0)
pdf("figures/breakaway-richness.comp.pdf",width = 8,height = 6.5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=2,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=2,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=2,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,4),col="lightblue",adj=0)
text(800,700,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,4),col="dodgerblue",adj=0)
text(800,200,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,4),col="darkblue",adj=0)
dev.off()
pdf("figures/breakaway-richness.comp.pdf",width = 8,height = 6.5)
plot(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.1rep),pch=16,cex=1.5,col="lightblue",ylim=c(0,2200),xlim=c(0,1100),
xlab="Breakaway Estimate",ylab="Observed Richness (8rep)")
abline(m1,col="lightblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.3rep),pch=16,cex=1.5,col="dodgerblue")
abline(m2,col="dodgerblue",lwd=1.5)
points(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8)),
colSums(euk.Nreps.high.binary.8rep),pch=16,cex=1.5,col="darkblue")
abline(m3,col="darkblue",lwd=1.5)
legend("topleft",border=NA,legend=c("1 rep","3 rep","8 rep"),col=c("lightblue","dodgerblue","darkblue"),pch=16,pt.cex=2)
text(800,1800,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.1rep)))$adj.r.squared,4),col="lightblue",adj=0)
text(800,700,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.3rep)))$adj.r.squared,4),col="dodgerblue",adj=0)
text(800,200,round(summary(lm(tapply(richEstimate,FUN=mean,INDEX = substr(names(richEstimate),1,8))~colSums(euk.Nreps.high.binary.8rep)))$adj.r.squared,4),col="darkblue",adj=0)
dev.off()
